<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <th:block th:replace="~{fragments/common-head :: head-elements(pageTitle='리소스 워크벤치')}"></th:block>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <style>
        /* 테이블 스타일 개선 */
        .table-cell-top {
            vertical-align: top;
            padding: 1rem 1.5rem;
        }

        /* 상태 아이콘 스타일 */
        .status-icon {
            width: 1.5rem;
            height: 1.5rem;
        }

        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.375rem;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            border: 1px solid;
        }

        /* 현대적인 버튼 스타일 */
        .modern-btn-primary {
            background: linear-gradient(135deg, #6366f1, #4f46e5);
            color: white;
            padding: 0.625rem 1.25rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.2);
        }

        .modern-btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(99, 102, 241, 0.3);
            background: linear-gradient(135deg, #7c7ff3, #5b5de7);
        }

        .modern-btn-secondary {
            background: rgba(71, 85, 105, 0.2);
            color: #cbd5e1;
            padding: 0.625rem 1.25rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.3s;
            border: 1px solid rgba(71, 85, 105, 0.3);
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
        }

        .modern-btn-secondary:hover {
            background: rgba(71, 85, 105, 0.3);
            border-color: rgba(71, 85, 105, 0.5);
            transform: translateY(-1px);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .modern-btn-refresh {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.9), rgba(37, 99, 235, 0.9));
            color: white;
            padding: 0.625rem 1.25rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.2);
        }

        .modern-btn-refresh:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.3);
            background: linear-gradient(135deg, rgba(96, 165, 250, 0.9), rgba(59, 130, 246, 0.9));
        }

        .modern-btn-refresh:hover i {
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* 액션 버튼 스타일 - 배지 스타일로 변경 */
        .action-badge-primary {
            background: rgba(99, 102, 241, 0.2);
            color: #818cf8;
            border: 1px solid rgba(99, 102, 241, 0.3);
            padding: 0.375rem 1rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            transition: all 0.3s;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 0.375rem;
        }

        .action-badge-primary:hover {
            background: rgba(99, 102, 241, 0.3);
            color: #a5b4fc;
            border-color: rgba(99, 102, 241, 0.5);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(99, 102, 241, 0.2);
        }

        .action-badge-secondary {
            background: rgba(239, 68, 68, 0.2);
            color: #f87171;
            border: 1px solid rgba(239, 68, 68, 0.3);
            padding: 0.375rem 1rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            transition: all 0.3s;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 0.375rem;
        }

        .action-badge-secondary:hover {
            background: rgba(239, 68, 68, 0.3);
            color: #fca5a5;
            border-color: rgba(239, 68, 68, 0.5);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(239, 68, 68, 0.2);
        }

        .action-badge-restore {
            background: rgba(34, 197, 94, 0.2);
            color: #4ade80;
            border: 1px solid rgba(34, 197, 94, 0.3);
            padding: 0.375rem 1rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            transition: all 0.3s;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 0.375rem;
        }

        .action-badge-restore:hover {
            background: rgba(34, 197, 94, 0.3);
            color: #86efac;
            border-color: rgba(34, 197, 94, 0.5);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(34, 197, 94, 0.2);
        }

        /* 액션 링크 스타일 개선 */
        .modern-action-link {
            padding: 0.375rem 0.875rem;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            background: linear-gradient(135deg, rgba(71, 85, 105, 0.2), rgba(51, 65, 85, 0.2));
            color: #cbd5e1;
            border: 1px solid rgba(71, 85, 105, 0.3);
            text-decoration: none;
        }

        .modern-action-link:hover {
            background: linear-gradient(135deg, rgba(71, 85, 105, 0.3), rgba(51, 65, 85, 0.3));
            color: #e2e8f0;
            border-color: rgba(71, 85, 105, 0.5);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        /* 페이지네이션 스타일 현대화 */
        .modern-pagination {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .modern-pagination .page-link {
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid rgba(71, 85, 105, 0.3);
            color: #cbd5e1;
            padding: 0.5rem 0.75rem;
            border-radius: 0.375rem;
            text-decoration: none;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 2.5rem;
            height: 2.5rem;
        }

        .modern-pagination .page-link:hover {
            background: rgba(71, 85, 105, 0.4);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .modern-pagination .page-item.active .page-link {
            background: linear-gradient(135deg, #6366f1, #4f46e5);
            border-color: transparent;
            color: white;
            box-shadow: 0 2px 10px rgba(99, 102, 241, 0.3);
        }

        .modern-pagination .page-item.disabled .page-link {
            background: rgba(30, 41, 59, 0.3);
            color: #475569;
            cursor: not-allowed;
            opacity: 0.5;
        }

        /* 테이블 스타일 현대화 */
        .modern-table {
            overflow: hidden;
            border-radius: 0.75rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .modern-table thead {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
        }

        .modern-table tbody {
            background: rgba(15, 23, 42, 0.6);
        }

        .modern-table tbody tr {
            transition: all 0.3s;
            border-bottom: 1px solid rgba(71, 85, 105, 0.2);
        }

        .modern-table tbody tr:last-child {
            border-bottom: none;
        }

        .modern-table tbody tr:hover {
            background: rgba(71, 85, 105, 0.15);
            transform: scale(1.001);
        }

        /* 입력 필드 스타일 개선 */
        .modern-input {
            background: rgba(30, 41, 59, 0.6);
            border: 2px solid rgba(71, 85, 105, 0.3);
            color: #e2e8f0;
            font-size: 0.875rem;
            padding: 0.625rem 1rem;
            border-radius: 0.5rem;
            transition: all 0.3s;
            width: 100%;
        }

        .modern-input:focus {
            background: rgba(30, 41, 59, 0.8);
            border-color: #6366f1;
            outline: none;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .modern-input::placeholder {
            color: #64748b;
        }

        .modern-select {
            background: rgba(30, 41, 59, 0.6);
            border: 2px solid rgba(71, 85, 105, 0.3);
            color: #e2e8f0;
            padding: 0.625rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            transition: all 0.3s;
            cursor: pointer;
            width: 100%;
        }

        .modern-select:focus {
            background: rgba(30, 41, 59, 0.8);
            border-color: #6366f1;
            outline: none;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .modern-select option {
            background: #1e293b;
            color: #e2e8f0;
        }

        /* 필터 영역 현대화 */
        .filter-container {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.4), rgba(51, 65, 85, 0.3));
            border: 1px solid rgba(71, 85, 105, 0.3);
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        /* 리소스 타입 배지 */
        .resource-type-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.625rem;
            font-weight: 700;
            text-transform: uppercase;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        /* 텍스트 스타일 개선 */
        .resource-identifier {
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 0.875rem;
            color: #cbd5e1;
            background: linear-gradient(135deg, rgba(15, 23, 42, 0.7), rgba(30, 41, 59, 0.7));
            padding: 0.75rem;
            border-radius: 0.5rem;
            margin-top: 0.5rem;
            border: 1px solid rgba(71, 85, 105, 0.3);
        }

        .resource-description {
            font-size: 0.75rem;
            color: #94a3b8;
            line-height: 1.5;
        }

        /* 날짜 표시 스타일 */
        .date-info {
            font-size: 0.75rem;
            color: #64748b;
            background: rgba(30, 41, 59, 0.3);
            padding: 0.375rem 0.75rem;
            border-radius: 0.375rem;
            display: inline-block;
        }

        .date-info .date-value {
            color: #94a3b8;
            font-weight: 600;
        }

        /* 헤더 영역 현대화 */
        .page-header {
            background: linear-gradient(135deg, rgba(15, 23, 42, 0.8), rgba(30, 41, 59, 0.6));
            border-radius: 0.75rem;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        /* 카드 스타일 현대화 */
        .modern-card {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(71, 85, 105, 0.3);
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
        }
    </style>
</head>
<body class="flex flex-col min-h-screen font-sans">
<div th:insert="~{fragments/header :: header}"></div>
<div id="toast-container" class="fixed top-5 right-5 z-50"></div>

<div class="flex flex-1 overflow-hidden">
    <aside th:insert="~{fragments/admin-menu :: menu}"></aside>

    <main class="flex-1 p-6 lg:p-8 overflow-y-auto">
        <div class="modern-card">
            <!-- 헤더 및 새로고침 버튼 -->
            <div class="page-header">
                <div class="flex flex-col sm:flex-row justify-between items-start gap-4">
                    <div>
                        <h1 class="text-3xl font-bold text-gradient">리소스 워크벤치</h1>
                        <p class="text-dark-muted mt-2 max-w-2xl">
                            시스템에서 자동 탐지된 기술 리소스를 검토하고, 비즈니스 의미를 부여하여 관리 가능한 '권한'으로 변환합니다.
                        </p>
                    </div>
                    <form th:action="@{/admin/workbench/resources/refresh}" method="post">
                        <button type="submit" class="modern-btn-refresh whitespace-nowrap">
                            <i class="fas fa-sync-alt"></i>
                            <span>리소스 새로고침</span>
                        </button>
                    </form>
                </div>
            </div>

            <!-- A. 필터 및 검색 영역 -->
            <form th:action="@{/admin/workbench/resources}" method="get" th:object="${criteria}" class="filter-container mb-8">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 items-end">
                    <div>
                        <label for="serviceOwner" class="block text-sm font-medium mb-2" style="color: #cbd5e1;">서비스 오너 (모듈)</label>
                        <select id="serviceOwner" th:field="*{serviceOwner}" class="modern-select">
                            <option value="">전체</option>
                            <option th:each="owner : ${serviceOwners}" th:value="${owner}" th:text="${owner}"></option>
                        </select>
                    </div>
                    <div>
                        <label for="status" class="block text-sm font-medium mb-2" style="color: #cbd5e1;">상태</label>
                        <select id="status" th:field="*{status}" class="modern-select">
                            <option value="">전체</option>
                            <option th:value="${T(io.spring.identityadmin.domain.entity.ManagedResource.Status).NEEDS_DEFINITION}">정의 필요</option>
                            <option th:value="${T(io.spring.identityadmin.domain.entity.ManagedResource.Status).PERMISSION_CREATED}">권한 생성됨</option>
                            <option th:value="${T(io.spring.identityadmin.domain.entity.ManagedResource.Status).POLICY_CONNECTED}">정책 연결됨</option>
                            <option th:value="${T(io.spring.identityadmin.domain.entity.ManagedResource.Status).EXCLUDED}">관리 제외만 보기</option>
                        </select>
                    </div>
                    <div>
                        <label for="keyword" class="block text-sm font-medium mb-2" style="color: #cbd5e1;">키워드</label>
                        <input type="text" id="keyword" th:field="*{keyword}" class="modern-input" placeholder="식별자, 설명 등...">
                    </div>
                    <div class="flex gap-2">
                        <button type="submit" class="modern-btn-primary flex-1">
                            <i class="fas fa-search"></i>
                            <span>검색</span>
                        </button>
                        <a th:href="@{/admin/workbench/resources}" class="modern-btn-secondary flex-1 text-center">
                            <i class="fas fa-redo"></i>
                            <span>초기화</span>
                        </a>
                    </div>
                </div>
            </form>

            <!-- B. 리소스 목록 -->
            <div class="modern-table overflow-x-auto">
                <table class="min-w-full text-sm">
                    <thead>
                    <tr>
                        <th class="py-4 px-6 text-center text-white text-xs uppercase font-semibold tracking-wider">상태</th>
                        <th class="py-4 px-6 text-left text-white text-xs uppercase font-semibold tracking-wider">친화적 이름 / 설명</th>
                        <th class="py-4 px-6 text-left text-white text-xs uppercase font-semibold tracking-wider">기술 식별자</th>
                        <th class="py-4 px-6 text-left text-white text-xs uppercase font-semibold tracking-wider">도구 및 이력</th>
                        <th class="py-4 px-6 text-left text-white text-xs uppercase font-semibold tracking-wider">작업</th>
                    </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-700">
                    <tr th:if="${resourcePage == null or resourcePage.empty}">
                        <td colspan="5" class="text-center py-12 text-slate-500">
                            <i class="fas fa-inbox text-4xl mb-3"></i>
                            <p>조건에 맞는 리소스가 없습니다.</p>
                        </td>
                    </tr>
                    <th:block th:if="${resourcePage != null}">
                        <tr th:each="res : ${resourcePage.content}">

                            <td class="table-cell-top text-center">
            <span class="status-badge"
                  th:classappend="${res.status?.name() == 'NEEDS_DEFINITION' ? 'bg-yellow-500/20 text-yellow-400 border-yellow-500/30' :
                                   res.status?.name() == 'PERMISSION_CREATED' ? 'bg-blue-500/20 text-blue-400 border-blue-500/30' :
                                   res.status?.name() == 'POLICY_CONNECTED' ? 'bg-green-500/20 text-green-400 border-green-500/30' :
                                   'bg-slate-500/20 text-slate-400 border-slate-500/30'}">
                <i th:class="${res.status?.name() == 'NEEDS_DEFINITION' ? 'fas fa-question-circle' :
                               res.status?.name() == 'PERMISSION_CREATED' ? 'fas fa-check-circle' :
                               res.status?.name() == 'POLICY_CONNECTED' ? 'fas fa-link' : 'fas fa-ban'}"></i>
                <span th:text="${res.status != null ?
                                (res.status.name() == 'NEEDS_DEFINITION' ? '정의 필요' :
                                 res.status.name() == 'PERMISSION_CREATED' ? '권한 생성됨' :
                                 res.status.name() == 'POLICY_CONNECTED' ? '정책 연결됨' : '관리 제외')
                                : '상태 미지정'}"></span>
            </span>
                            </td>

                            <td class="table-cell-top resource-inputs-cell">
                                <div class="input-container" th:attr="data-resource-id=${res.id}">
                                    <input type="text" name="friendlyName" th:value="${res.friendlyName}"
                                           class="modern-input font-semibold mb-3"
                                           placeholder="관리용 이름 입력" required>
                                    <textarea name="description"
                                              class="modern-input"
                                              rows="2"
                                              placeholder="관리용 상세 설명 입력"
                                              th:text="${res.description}"></textarea>
                                </div>
                            </td>

                            <td class="table-cell-top">
                                <div class="mb-2">
                <span class="resource-type-badge"
                      th:text="${res.resourceType}"
                      th:classappend="${res.resourceType?.name() == 'URL' ? 'bg-blue-500/20 text-blue-400' : 'bg-purple-500/20 text-purple-400'}"></span>
                                </div>
                                <div class="resource-identifier" th:text="${res.resourceIdentifier}"></div>
                                <p class="resource-description mt-2" th:text="${res.description}"></p>
                            </td>

                            <td class="table-cell-top">
                                <div class="flex flex-wrap items-center gap-2 mb-3">
                                    <a th:if="${res.sourceCodeLocation}" href="#" class="modern-action-link" th:title="${res.sourceCodeLocation}">
                                        <i class="fas fa-code"></i> 코드
                                    </a>
                                    <a th:if="${res.apiDocsUrl}" th:href="@{${res.apiDocsUrl}}" target="_blank" class="modern-action-link">
                                        <i class="fas fa-book-open"></i> API
                                    </a>
                                </div>
                                <div class="date-info">
                                    <i class="fas fa-clock text-xs mr-1"></i>
                                    최초 발견: <span class="date-value" th:text="${#temporals.format(res.createdAt, 'yyyy-MM-dd HH:mm')}"></span>
                                </div>
                            </td>

                            <td class="table-cell-top">
                                <div class="space-y-2">
                                    <div th:if="${res.status?.name() == 'NEEDS_DEFINITION' or res.status?.name() == 'PERMISSION_CREATED'}">
                                        <button type="button" class="action-badge-primary w-full text-center"
                                                th:attr="data-resource-id=${res.id}"
                                                onclick="defineAndSetupPolicy(this)">
                                            <i class="fas fa-magic"></i>
                                            <span>권한 정의 & 정책 설정</span>
                                        </button>
                                    </div>

                                    <div th:if="${res.status?.name() == 'POLICY_CONNECTED'}"
                                         class="text-xs text-center p-2 rounded-full bg-green-500/20 text-green-400 border border-green-500/30">
                                        <i class="fas fa-link mr-1"></i> 정책에 연결됨
                                    </div>

                                    <div th:if="${res.status?.name() != 'EXCLUDED'}">
                                        <form th:action="@{/admin/workbench/resources/{id}/exclude(id=${res.id})}" method="post">
                                            <button type="submit" class="action-badge-secondary w-full text-center">
                                                <i class="fas fa-ban"></i>
                                                <span>관리 제외</span>
                                            </button>
                                        </form>
                                    </div>

                                    <div th:if="${res.status?.name() == 'EXCLUDED'}">
                                        <form th:action="@{/admin/workbench/resources/{id}/restore(id=${res.id})}" method="post">
                                            <button type="submit" class="action-badge-restore w-full text-center">
                                                <i class="fas fa-undo"></i>
                                                <span>관리 복원</span>
                                            </button>
                                        </form>
                                    </div>
                                </div>
                            </td>
                        </tr>
                    </th:block>
                    </tbody>
                </table>
            </div>

            <!-- 페이지네이션 UI -->
            <nav th:if="${resourcePage != null and resourcePage.totalPages > 1}" aria-label="Page navigation" class="mt-8 flex justify-center">
                <ul class="modern-pagination">
                    <li class="page-item" th:classappend="${resourcePage.first} ? 'disabled'">
                        <a class="page-link" th:href="@{/admin/workbench/resources(page=${resourcePage.number - 1}, keyword=${criteria.keyword}, serviceOwner=${criteria.serviceOwner}, status=${criteria.status})}">
                            <i class="fas fa-chevron-left"></i>
                        </a>
                    </li>
                    <li th:each="pageNumber : ${#numbers.sequence(0, resourcePage.totalPages - 1)}"
                        class="page-item" th:classappend="${pageNumber == resourcePage.number} ? 'active'">
                        <a class="page-link" th:href="@{/admin/workbench/resources(page=${pageNumber}, keyword=${criteria.keyword}, serviceOwner=${criteria.serviceOwner}, status=${criteria.status})}" th:text="${pageNumber + 1}"></a>
                    </li>
                    <li class="page-item" th:classappend="${resourcePage.last} ? 'disabled'">
                        <a class="page-link" th:href="@{/admin/workbench/resources(page=${resourcePage.number + 1}, keyword=${criteria.keyword}, serviceOwner=${criteria.serviceOwner}, status=${criteria.status})}">
                            <i class="fas fa-chevron-right"></i>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </main>
    <div id="policySetupModal" class="fixed inset-0 z-50 hidden flex items-center justify-center">
        <div class="fixed inset-0 bg-black/80 backdrop-blur-sm"></div>
        <div class="relative dark-card rounded-2xl p-8 max-w-3xl w-full mx-auto shadow-2xl">
            <div class="text-center mb-8">
                <h2 class="text-2xl font-bold text-gradient mb-2">정책 설정 방식 선택</h2>
                <p class="text-dark-secondary">
                    생성될 '<span id="modal-permission-name" class="text-indigo-400 font-semibold"></span>' 권한에 대한 정책을 어떻게 설정하시겠습니까?
                </p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <div class="dark-card p-6 rounded-xl border-2 border-transparent hover:border-indigo-500/50 transition-all duration-300 cursor-pointer h-full"
                     onclick="selectQuickGrant()">
                    <h3 class="text-lg font-bold text-dark-primary mb-2">빠른 권한 부여 (마법사)</h3>
                    <p class="text-sm text-dark-muted leading-relaxed">기존 역할에 이 권한을 즉시 부여하는 가장 빠른 방법입니다. 복잡한 조건은 설정할 수 없습니다.</p>
                </div>
                <div class="dark-card p-6 rounded-xl border-2 border-transparent hover:border-purple-500/50 transition-all duration-300 cursor-pointer h-full"
                     onclick="selectAdvancedPolicy()">
                    <h3 class="text-lg font-bold text-dark-primary mb-2">지능형 정책 설정 (빌더)</h3>
                    <p class="text-sm text-dark-muted leading-relaxed">AI 리스크 평가, 특정 시간/IP 등 동적이고 세밀한 조건을 포함한 정책을 설정합니다.</p>
                </div>
            </div>
            <div class="flex justify-center">
                <button type="button" onclick="closePolicySetupModal()" class="dark-btn-secondary">나중에 설정하기</button>
            </div>
        </div>
    </div>

    <form id="quickGrantForm" method="post" th:action="@{/admin/policy-wizard/start}" class="hidden">
        <input type="hidden" name="permissionId" id="quickGrantPermissionId">
    </form>
    <form id="advancedPolicyForm" method="post" th:action="@{/admin/policy-builder/from-resource}" class="hidden">
        <input type="hidden" name="resourceId" id="advancedPolicyResourceId">
        <input type="hidden" name="permissionId" id="advancedPolicyPermissionId">
    </form>
</div>
<script th:src="@{/js/toast.js}"></script>
<script th:src="@{/js/resource-workbench.js}"></script>
<script th:inline="javascript">
    document.addEventListener('DOMContentLoaded', () => {
        const message = /*[[${message}]]*/ null;
        if (message) {
            showToast(message, 'success');
        }
        const errorMessage = /*[[${errorMessage}]]*/ null;
        if (errorMessage) {
            showToast(errorMessage, 'error');
        }
    });
</script>
</body>
</html>