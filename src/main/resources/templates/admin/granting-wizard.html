<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <th:block th:replace="~{fragments/common-head :: head-elements(pageTitle='권한 부여 마법사')}"></th:block>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <!-- granting-wizard.css 추가 예정 -->
</head>
<body class="flex flex-col min-h-screen font-sans">
<div th:insert="~{fragments/header :: header}"></div>
<div id="toast-container" class="fixed top-5 right-5 z-50"></div>

<div class="flex flex-1 overflow-hidden">
    <aside th:insert="~{fragments/admin-menu :: menu}"></aside>

    <main class="flex-1 p-6 lg:p-8 overflow-y-auto">
        <div id="granting-wizard-container" class="dark-card p-6 sm:p-8 rounded-xl" th:data-context-id="${contextId}">
            <!-- 헤더 -->
            <div class="mb-8 flex justify-between items-center">
                <div>
                    <h1 class="text-3xl font-bold text-gradient">권한 부여 마법사</h1>
                    <p class="text-dark-muted mt-2">
                        주체 <strong id="subject-name" class="text-indigo-300">사용자 이름</strong>의 그룹 및 역할 멤버십을 관리합니다.
                    </p>
                </div>
                <div>
                    <a th:href="@{/admin/studio}" class="dark-btn-secondary">취소</a>
                    <button id="save-button" type="button" class="dark-btn-primary ml-2">
                        <i class="fas fa-save mr-2"></i>저장
                    </button>
                </div>
            </div>

            <!-- 3단 패널 -->
            <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
                <!-- 좌측: 선택 목록 -->
                <div id="selection-panel" class="lg:col-span-4 dark-card p-4">
                    <h3 class="font-semibold text-lg text-slate-300 mb-4">전체 그룹 목록</h3>
                    <div class="h-96 overflow-y-auto space-y-2 pr-2">
                        <div th:each="group : ${allGroups}" class="dark-checkbox-item">
                            <input type="checkbox" th:value="${group.id}" th:id="'group-'+${group.id}"
                                   th:checked="${#lists.contains(selectedGroupIds, group.id)}" class="dark-checkbox">
                            <label th:for="'group-'+${group.id}" class="text-slate-200" th:text="${group.name}"></label>
                        </div>
                    </div>
                </div>

                <!-- 중앙: 현재 할당 (JS로 동적 관리) -->
                <div id="assignment-panel" class="lg:col-span-4 dark-card p-4">
                    <h3 class="font-semibold text-lg text-slate-300 mb-4">현재 할당된 그룹</h3>
                    <div id="assignment-list" class="h-96 overflow-y-auto space-y-2 pr-2">
                        <!-- JS로 동적으로 채워짐 -->
                    </div>
                </div>

                <!-- 우측: 실시간 분석 -->
                <div id="simulation-panel" class="lg:col-span-4 dark-card p-4">
                    <h3 class="font-semibold text-lg text-slate-300 mb-4">실시간 영향 분석</h3>
                    <div id="simulation-result-container" class="h-96 overflow-y-auto space-y-4">
                        <div class="flex items-center justify-center h-full text-slate-500">
                            변경사항 발생 시 분석 결과가 여기에 표시됩니다.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>
<script th:src="@{/js/toast.js}"></script>
<script th:src="@{/js/granting-wizard.js}"></script>
</body>
</html>